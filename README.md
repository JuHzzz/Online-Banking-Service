# Java Web 网上银行

银行管理系统


系统介绍
本系统中主要包括银行卡办理，账户查询，转账汇款，充值缴费四部分功能。每一个功能都有具体的显示部分和逻辑控制部分。另外通过合法性验证，
处理表单的重复提交及数据的暂存，支付过程中的安全性问题（如事务的系统故障和事务内部故障）的控制，进而大大提高了系统的安全性和可维护性。
本系统采用MVC的开发模式，采用前台JSP+HTML+JavaScript+CSS,后台采用jdbc+servlet+JavaBean+MySql的技术栈，涵盖事务以及存储过程的实现，
并通过session实现会话跟踪,保障系统的安全性与可靠性。

1.注册页面
--1.身份证合法性验证
①获取长度为18位的身份证Id
②校验前17位是否为纯数字
③校验区位码是否合法
④校验出生年月日格式是否合法
--①是否是yyyyMMdd格式
--②是否出现平年里边存在2月29日
⑤校验顺序码
--①找出来前17位id
--②根据身份证编码规则校验
*建立一张身份证区位码表，验证合法ID

--2.姓名合法性验证
①设置名字长度最长为15位
②要求不能含有数字
③不能含有空格

--3.手机号合法性验证
①检测手机号是否含有空格
②手机号长度是否合法
③是否是纯数字
④手机号开头是否合法
*建立一张手机号区号表，记录合法的手机号开头

--4.邮箱合法性验证
①通过正则表达式设置合法邮箱格式

--3.支付密码合法性验证
①是否是纯数字
②密码长度是否合法
2.查询页面

①卡号密码合法性验证
②通过session将查询结果显示在结果页面
3.转账页面

①转账信息合法性验证
②将用户填入的信息存储在Map集合中，通过session暂存Map中保存的用户数据，当确认密码正确后，将用户交易记录写入定义的日志中，通过调用数据库存储过程，
处理转账事务，更新数据库后完成转账，并清除session。
4.充值页面

①充值信息合法性验证
②充值信息确认无误后，将用户数据咱存在session中，跳转至支付页面。
③用户输入卡号密码确认无误后，将用户交易记录写入日志中，调用存储过程，处理充值事务，更新数据库后完成充值，清空session。



*安全问题：
1.表单的重复提交
设置一个隐藏域，当第一次通过浏览器访问向后台发送数据后，用Date()创建并绑定到此次会话，当提交请求时，服务器端会将会话中的此属性和请求中传来的参数进行
比对，如果一致，则表明是同一次会话，请求结束后，将请求中的此属性移除。当重复提交时，会从客户端再次传来一个隐藏域中的参数，而这时我的session中的属性
已经为空，表明是重复提交，系统就不允许。

5.表单提交数据的暂存问题
*注册页面为二级页面，当我提交过个人信息并验证数据库中不存在当前ID用户的信息时，跳转到下一级页面，但前一级页面中用户的信息暂不录入库中，将它暂存在会话
缓存中，这个通过Session来实现，因为session是在服务器端保存信息的，我就可以通过将头部的一些信息组合起来生成一个加密的token，这样攻击者就很难猜测出我
的token是如何生成的，确保了会话的安全性，用户填写的个人信息，就不会被攻击者截取到。当二级页面中用户设置完密码，验证无误后，提交数据录入到数据库中。
注册就已经完成。
？当第一级页面验证无误并提交后，是否可以将请求转发给另外一个servletB，但是同样需要重定向到二级页面，二级页面处理完成之后，请求同样提交到servletB，
进行入库的处理。（用户的信息暂存到Session中）
6.转账支付过程中数据库安全性问题
*在支付转账方法中,通过调用数据库中定义的存储过程，在存储过程中添加带参数的事务，每次用户转账时，通过接收用户输入的收款卡号付款卡号转账金额，
在数据库中进行修改。这样做也可以很有效的对系统故障，做出响应。
*为了防止数据丢失，及非法篡改，专门写了一个记录交易信息的日志。当用户资金发生变化时，总要先在日志中进行添加操作。
